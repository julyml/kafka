docker run --network kafka-airflow-setup_default --tty --interactive --rm \
          confluentinc/cp-kafkacat \
          kafkacat -b kafka:9092 \
          -C -t topic_a \
          -o beginning

docker run --network kafka-airflow-setup_default \                                      
           --interactive --tty --rm \
           confluentinc/cp-ksql-cli:latest \
           http://ksql-server:8088

select * from user_actions where timestamp >= 1618398000 AND timestamp <= 1618405200;


create table user_actions( id BIGINT, deviceId VARCHAR, timestamp BIGINT, action VARCHAR, videoId BIGINT, duration BIGINT, playbackPercentage BIGINT, playerType VARCHAR, channel VARCHAR, title VARCHAR, displayArtist VARCHAR)  WITH (KAFKA_TOPIC='topic_a', VALUE_FORMAT='JSON', key='id');



docker run --network kafka-airflow-setup_default --tty --interactive --rm \
          confluentinc/cp-kafkacat \
          kafkacat -b kafka:9092 \
          -C -t topic_a \
          -o beginning -c 1


docker run --network kafka-airflow-setup_default \
            --tty --interactive --rm \
            confluentinc/cp-kafkacat \
            kafkacat -b kafka:9092 -C -K: \
            -f '\nKey: %k\t\nValue: %s\n\Partition: %p\tOffset: %o\n--\n' \ 
            -t topic_a \
            -o 1 \ 
            -p 0 \ 
            -c 1   


PRINT 'USER_ACTIONS' FROM BEGINNING LIMIT 1;